# Game-Shiru システム設計書

## 1. システム構成図の解説

### 技術スタック
Game-Shiruは、以下の技術スタックを使用したゲーム推薦システムです：

- **フロントエンド**: HTML5, CSS3, JavaScript
- **バックエンド**: Python Flaskウェブフレームワーク
- **データベース**: SQLite（SQLAlchemy ORMを使用）
- **アーキテクチャ**: MVCパターン + DAO（Data Access Object）デザインパターン

### データフロー
システムのデータフローは以下のようになります：

1. **ユーザー**がブラウザを通じてHTTPリクエストを送信
2. **Flaskアプリケーションサーバー**がリクエストを受け取り、処理を実行
3. **GameDAO**がデータベース操作を担当
4. **SQLiteデータベース**から必要なデータを取得
5. **Flaskサーバー**がHTML/CSS/JSを生成し、ユーザーに返却
6. **静的ファイルサーバー**がCSSや画像などの静的リソースを提供
7. **外部CDNサービス**（Google Fonts, Cropper.js）が追加機能を提供

### 主要コンポーネントの役割

#### ユーザー（ブラウザ）
- システムのフロントエンドインターフェース
- ゲームの検索、詳細表示、管理機能を提供
- 管理者認証機能を備える

#### Flaskアプリケーションサーバー
- Python Flaskで構築されたウェブアプリケーション
- HTTPリクエストの処理とビジネスロジックの実行
- テンプレートエンジン（Jinja2）を使用したHTML生成
- セッション管理と認証機能

#### GameDAO（Data Access Object）
- データベース操作の専用レイヤー
- CRUD操作（作成、読み取り、更新、削除）の実装
- トランザクション管理とSQLインジェクション防止
- ビジネスロジックとデータベースの間のインターフェース

#### SQLiteデータベース
- 軽量なリレーショナルデータベース
- 正規化されたスキーマ（第3正規形）
- 7つのテーブルで構成されたゲーム情報管理
- 外部キー制約によるデータ整合性の保持

#### 静的ファイルサーバー
- CSSスタイルシートの提供
- ゲーム画像の保存と配信
- アップロードされたファイルの管理

#### 外部CDNサービス
- **Google Fonts**: 日本語フォント（Noto Sans JP）の提供
- **Cropper.js**: 画像編集機能の提供

## 2. ER図の解説

### 主要エンティティと保持データ

#### ゲーム（gamesテーブル）
ゲームの基本情報を保持する主要エンティティです。

- **ゲームID**: ゲームを一意に識別する主キー
- **タイトル**: ゲームの名称
- **リリース日**: ゲームの発売日
- **説明**: ゲームの詳細説明文
- **評価**: ゲームの評価スコア（0.0〜10.0）
- **価格**: ゲームの価格
- **画像URL**: ゲーム画像のパス
- **開発者ID**: 開発者テーブルへの外部キー
- **ジャンルID**: ジャンルテーブルへの外部キー

#### 開発者（developersテーブル）
ゲーム開発会社の情報を管理します。

- **開発者ID**: 開発者を一意に識別する主キー
- **名前**: 開発会社の名称
- **国**: 開発会社の所在地
- **設立年**: 会社の設立年
- **ウェブサイト**: 会社の公式ウェブサイトURL

#### ジャンル（genresテーブル）
ゲームのジャンル情報を管理します。

- **ジャンルID**: ジャンルを一意に識別する主キー
- **名前**: ジャンルの名称（例：アクション、RPGなど）
- **説明**: ジャンルの詳細説明

#### プラットフォーム（platformsテーブル）
ゲームプラットフォームの情報を管理します。

- **プラットフォームID**: プラットフォームを一意に識別する主キー
- **名前**: プラットフォームの名称（例：PlayStation, Xboxなど）
- **メーカー**: プラットフォームの製造会社
- **リリース年**: プラットフォームの発売年

#### タグ（preferencesテーブル）
ゲームのタグ情報を管理します。

- **タグID**: タグを一意に識別する主キー
- **名前**: タグの名称
- **カテゴリ**: タグの種類（ジャンルまたは好み）

### エンティティ間の関係

#### 1. ゲームと開発者の関係（1対多）
- **関係**: 1人の開発者は複数のゲームを開発できる
- **実装**: 開発者テーブルの主キー（開発者ID）がゲームテーブルの外部キーとして参照される
- **例**: 「任天堂」という開発者が「マリオ」と「ゼルダ」という複数のゲームを開発

#### 2. ゲームとジャンルの関係（1対多）
- **関係**: 1つのジャンルに複数のゲームが属する
- **実装**: ジャンルテーブルの主キー（ジャンルID）がゲームテーブルの外部キーとして参照される
- **例**: 「アクション」ジャンルに「マリオ」と「ソニック」という複数のゲームが属する

#### 3. ゲームとプラットフォームの関係（多対多）
- **関係**: 1つのゲームは複数のプラットフォームでリリースでき、1つのプラットフォームには複数のゲームが存在できる
- **実装**: ゲームプラットフォーム接続テーブル（game_platforms）を使用
- **例**: 「マリオ」というゲームが「Nintendo Switch」と「Wii U」という複数のプラットフォームでリリース

#### 4. ゲームとタグの関係（多対多）
- **関係**: 1つのゲームには複数のタグが付与でき、1つのタグは複数のゲームに適用できる
- **実装**: ゲームタグ接続テーブル（game_tags）を使用
- **例**: 「マリオ」というゲームに「アクション」「アドベンチャー」「ファミリー」という複数のタグが付与

### 接続テーブルの役割

#### ゲームプラットフォーム（game_platformsテーブル）
ゲームとプラットフォームの間の多対多関係を実現する接続テーブルです。

- **ゲームID**: ゲームテーブルへの外部キー
- **プラットフォームID**: プラットフォームテーブルへの外部キー
- **複合主キー**: ゲームIDとプラットフォームIDの組み合わせが主キー

#### ゲームタグ（game_tagsテーブル）
ゲームとタグの間の多対多関係を実現する接続テーブルです。

- **ゲームID**: ゲームテーブルへの外部キー
- **タグID**: タグテーブルへの外部キー
- **複合主キー**: ゲームIDとタグIDの組み合わせが主キー

### データ整合性の保持
- すべての外部キー関係に参照整合性制約が設定されています
- SQLiteが適切なインデックスを使用してパフォーマンスを最適化
- 第3正規形（3NF）に正規化されたデータベース設計
- トランザクション管理によるデータの一貫性保持
